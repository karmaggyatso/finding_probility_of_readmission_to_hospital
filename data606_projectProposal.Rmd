---
title: "data606_project_proposal"
author: "karmaGyatso"
date: '2022-10-31'
output:
  pdf_document: default
  html_document: default
---

## Data Presentation

```{r}
library(tidyverse)
library(ggplot2)
library(cowplot)
```

## Loading data from github, which was downloaded from Kaggle. classifying the dataset type and printing all the names of the variables. 
```{r}
patient_records_test <- read.csv("https://raw.githubusercontent.com/karmaggyatso/CUNY_SPS/main/data606_project/proporsal/Train-1617360447408-1660719685476.csv")

class(patient_records_test)

names(patient_records_test)
```


## Research question 
**What is the main factor of patient readmission in the hospital? Are the treatment and age group the reason for readmission? What are the chances of readmission based on medical treatment and age group?**



```{r}
dim(patient_records_test)
```

## ### Cases 

**Each case represents individual patient who went to hospital for treatment. There are *66,587* observations**

## Data collection 

**The data was downloaded from Kaggle and then uploaded to Github to be read from (in its raw form).**


## Type of study 
**This is an observational study**

## Data Source

**Data source cited in MLA 9th edition**
 + Vutukuri, Girish. “Hospital_Administration.” Hospital_Administration | Kaggle, www.kaggle.com/datasets/girishvutukuri/hospital-administration/code?resource=download. Accessed 30 Oct. 2022.

## Dependent Variable
**Probability: this is a quantitative (numeric) variable that describes the probability by which the Occuptation is likely to be automated in the future.**

## Independent Variable(s)
  + **medical_specialty:**  this is a qualitative variable that describes the type of role that is in question
  + **age_group: ** this is also a qualitative variable 
  

## Cleaning data

```{r}
str(patient_records_test)
```


```{r}
#cleaning only columns that is necessary for analysis
patient_records_test$gender <- as.factor(patient_records_test$gender) #chaning the datatype to factor
patient_records_test[patient_records_test == "?"] <- NA  # changing every ? to NA

#changing the data value of readmitted. 0 = NO and 1 = YES
patient_records_test[patient_records_test$readmitted == 0,]$readmitted <- "NO"
patient_records_test[patient_records_test$readmitted == 1,]$readmitted <- "YES"
patient_records_test$readmitted <- as.factor(patient_records_test$readmitted)

patient_records_test$age <- as.factor(patient_records_test$age) #changing the datatype to factor because it is categorical value

patient_records_test$medical_specialty <- as.factor(patient_records_test$medical_specialty) #changing the datatype to factor because it is categorical value

patient_records_test$race <- as.factor(patient_records_test$race)

```

```{r}
summary(patient_records_test$gender)
```

```{r}
summary(patient_records_test$readmitted)
```


```{r}
summary(patient_records_test$age)

```

```{r}
summary(patient_records_test$medical_specialty)

```

```{r}
#rechecking the value

str(patient_records_test)
```



```{r}
#checking count of each treatment and arrange to highest to lowest treatment
hospital_readmission_by_treatment <- patient_records_test |> 
  filter(readmitted == 1) |>
  filter(medical_specialty != "?") |>
  group_by(medical_specialty) |>
  count() |> 
  arrange(desc(n))


hospital_readmission_by_treatment

```

```{r}
#from the data set, choosing internal_medicine

internal_medicine_treatement <- patient_records_test %>%
  select(patient_id, age, gender, race, medical_specialty, time_in_hospital, readmitted) %>%
  filter(medical_specialty == "InternalMedicine") %>%
  drop_na()

internal_medicine_treatement
```
```{r}
str(internal_medicine_treatement)
```


## Analysis

According to the chart, we can see that graph is left-skewed distribution. We can also see that the Caucasian are the most common patient for internal medicine and they most visited age is between 70 - 80 young old. 

```{r}
ggplot(internal_medicine_treatement, aes(x = age)) +
  geom_bar(aes(fill = race )) + 
  labs(title= "Hospital readmission by age",
       x="age_group",y="total count")
```



## Frequency Count

Quick frequency count on column readmittedm, race, and age
```{r}
xtabs(~ readmitted + 
        race + age, data = internal_medicine_treatement)
```


## GLM(generalized linear models) function
using *glm()* to generate a model object amd it is named as *logistc*. 

```{r}
logistc <- glm(readmitted ~  age + race, data = internal_medicine_treatement, family = "binomial")

summary(logistc)
```

## Created Data frame from the model object
```{r}
predicted.data <- data.frame(
  probility.of.readmission.based.on.treatement = logistc$fitted.values, readmitted = internal_medicine_treatement$readmitted
)

predicted.data
```


```{r}
prediction <- internal_medicine_treatement %>%
  mutate(prob_readmission = logistc$fitted.values) %>%
  select(patient_id, prob_readmission, age, race, readmitted) %>%
  arrange(desc(prob_readmission))

prediction

```





